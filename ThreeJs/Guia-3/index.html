<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Objetos 3D Blender - ThreeJs</title>
</head>
<body>

    <h1 style="text-align: center">Objetos 3D Blender - ThreeJs</h1>

    <div id="myStats"></div>

    <script src="https://threejs.org/build/three.min.js"></script>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/libs/stats.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.js"></script>

    <script>
        let scene
        let camera
        let renderer
        let mesh
        let controls
        let stats

        let _controls = new (function(){
            this.rotationSpeedY = 0.02
        })

        function createCamera() {
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                1,
                100
                );
            camera.position.set(0, 0, 20);
            controls = new THREE.OrbitControls(camera);
        }

        function createRenderer() {
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
        }

        function axesHelper() {
            const axesHelper = new THREE.AxesHelper(50);
            scene.add(axesHelper);
        }

        function createLightDirectional() {
            let directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.name = "luz direccional";
            directionalLight.position.set(-15, 10, 0);
            scene.add(directionalLight);
        }

        function createLightSpot() {
            let spotLight = new THREE.SpotLight(0xff0000);
            spotLight.castShadow = true;
            spotLight.shadow.mapSize.width = 1024;
            spotLight.shadow.mapSize.height = 1024;
            spotLight.shadow.camera.near = 50;
            spotLight.shadow.camera.far = 400;
            spotLight.shadow.camera.fov = 3;
            spotLight.position.set(0, 10, 5);
            spotLight.name = "luz lugar";
            scene.add(spotLight);
        }

        function createStats() {

            stats = new Stats()
            stats.setMode(2)
            stats.domElement.style.position = "absolute"
            stats.domElement.style.top = "80px"
            stats.domElement.style.left = "9px"
            document.getElementById("myStats").appendChild(stats.domElement)
            return stats

        }

        function createDataGui(){
            let gui = new dat.GUI()
            gui.add(_controls, "rotationSpeedY", 0, 1)
        }

        function loadGLTF() {
            let loader = new THREE.GLTFLoader();
    
            loader.load('./tetera.glb', (gltf) => {
                mesh = gltf.scene
                scene.add(mesh)
            });
        }

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x6A6A6A);
            createCamera()
            loadGLTF()
            axesHelper()
            createLightDirectional()
            createLightSpot()
            createRenderer()
            createStats()
            createDataGui()
        }
    
        function animate(time) {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
            controls.update()
            stats.update()

            mesh.rotation.y += _controls.rotationSpeedY
        }
        init();
        requestAnimationFrame(animate);
    </script>
</body>
</html>