<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicio Edificios</title>
</head>
<body>

    <div id="myStats"></div>
    
    <script
    src="https://cdnjs.cloudflare.com/ajax/libs/three.js/94/three.min.js"
    integrity="sha512-ZGgXd6TB5qjtvTU6Q5o/LJM4pwLNy8U8XXJh+vJZDXp2wC8ASrl4WOeivaq2fpYc3TnTCLzyDvVjY8YhvNYaXg=="
    crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/libs/stats.min.js"></script>
    <script src="https://unpkg.com/three@0.85.0/examples/js/libs/stats.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.js"></script>


    <script>

        let scene
        let camera
        let renderer
        let material
        let plane
        let controls
        let stats

        let _controls = new (function(){
            this.addBuilding = function(){
                let cubePositionX = Math.floor(Math.random() * (52 - (-53)) + (-53))
                let cubePositionY = Math.floor(Math.random() * (0 - (-53)) + (-53))
                let cubeSizeXY = Math.floor(Math.random() * (10 - 4) + (4))
                let cubeSizeZ = Math.floor(Math.random() * (40 - 10) + (4))
                
                let geometry = new THREE.CubeGeometry(cubeSizeXY, cubeSizeXY, cubeSizeZ);
                new THREE.MeshPhongMaterial({color: Math.random() * 0xffffff })
                cube = new THREE.Mesh(geometry, material);
                cube.name = "cube";

                cube.position.set(cubePositionX, cubePositionY, cubeSizeZ/2);
                
                scene.add(cube)
            }
        })
        
        function createCamera() {
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                1,
                100
            )
                camera.position.set(0, 0, 100);
                controls = new THREE.OrbitControls(camera)
        }
            
        function createRenderer() {
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
        }
        
        function createPlane() {
            geometry = new THREE.PlaneGeometry(120, 120, 1, 1);
            let material = new THREE.MeshPhongMaterial({ color: 0x6A6A6A });
            plane = new THREE.Mesh(geometry, material);
            plane.name = "plane";
            scene.add(plane);
        }
        
        function createLightDirectional() {
            let directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.name = "luz direccional";
            directionalLight.position.set(-15, 10, 0);
            scene.add(directionalLight);
        }

        function createLightPoint() {
            let light = new THREE.PointLight(0xff0000, 1, 100);
            let sphere = new THREE.SphereGeometry(0.5, 16, 8);
            light.position.set(50, 50, 50);
            light.name = "luz punto";
            light.add(
                    new THREE.Mesh(
                    sphere,
                    new THREE.MeshBasicMaterial({ color: 0xff0040 })
                    )
                );
            light.position.set(13, 0, -7);
            scene.add(light);
        }

        function createLightSpot() {
            let spotLight = new THREE.SpotLight(0xff0000);
            spotLight.castShadow = true;
            spotLight.shadow.mapSize.width = 2048;
            spotLight.shadow.mapSize.height = 2048;
            spotLight.shadow.camera.near = 50;
            spotLight.shadow.camera.far = 400;
            spotLight.shadow.camera.fov = 3;
            spotLight.position.set(-50, -50, 5);
            spotLight.name = "luz lugar";
            scene.add(spotLight);
        }

        function axesHelper() {
            const axesHelper = new THREE.AxesHelper(50);
            scene.add(axesHelper);
        }

        function createStats() {
            
            stats = new Stats()
            stats.setMode(2)
            stats.domElement.style.position = "absolute"
            stats.domElement.style.left = "10px"
            stats.domElement.style.top = "140px"
            document.getElementById("myStats").appendChild(stats.domElement)
            return stats

        }

        function createDataGui(){
            let gui = new dat.GUI()
            gui.add(_controls, "addBuilding")
        }

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xFFE8E8);
            scene.fog = new THREE.Fog(0xFFD4D4, 10, 120);
            createCamera()
            createPlane()
            axesHelper()
            createLightDirectional()
            createLightPoint()
            createLightSpot()
            createRenderer()
            createStats()
            createDataGui()
        }
    
        function animate(time) {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
            controls.update()
            stats.update()
        }
        init();
        requestAnimationFrame(animate); 

        function generarLetra(){
            let letras = ["a","b","c","d","e","f","0","1","2","3","4","5","6","7","8","9"];
            let numero = (Math.random()*15).toFixed(0);
            return letras[numero];
        }
            
        function colorHEX(){
            let color = "";
            for(var i=0;i<6;i++){
                color = color + generarLetra() ;
            }
            return color;
        }

    </script>

</body>
</html>